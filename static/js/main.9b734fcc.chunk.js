(this.webpackJsonpproject10=this.webpackJsonpproject10||[]).push([[0],{12:function(e,t,a){e.exports=a(18)},17:function(e,t,a){},18:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(7),l=a.n(o),c=(a(17),a(10)),i=a(4),s=a(5),u=a(11),p=a(9),d=a(8),m=a.n(d);var h=function(){return r.a.createElement("header",{className:"header"},r.a.createElement("img",{className:"header__logo",src:m.a,alt:"Around the US"}))},_=r.a.createContext();var f=function(e){var t=r.a.useContext(_),a=e.card.owner._id===t._id,n=e.card.likes.some((function(e){return e._id===t._id}));function o(){var t=!n;e.onLike(e.card,t)}return r.a.createElement("li",{key:e.index,className:"elements__element"},a?r.a.createElement("button",{id:"elements__trash ",className:"elements__trash",onClick:function(){e.onDelete(e.card)}}):"",r.a.createElement("img",{className:"elements__image",onClick:function(){e.onImgClick(e.card)},src:e.card.link,alt:e.card.name}),r.a.createElement("div",{className:"elements__photo-bottom "},r.a.createElement("p",{className:"elements__text "}," ",e.card.name," "),n?r.a.createElement("button",{className:"elements__heart elements__heart_clicked",onClick:o}):r.a.createElement("button",{className:"elements__heart",onClick:o}),r.a.createElement("p",{className:"elements__heart_likes "}," ",e.card.likes.length)))};var v=function(e){var t=r.a.useContext(_);return r.a.createElement("main",null,r.a.createElement("section",{className:"profile"},r.a.createElement("div",{className:"profile__avatar-overlay",onClick:e.onAvatarClick},r.a.createElement("img",{src:t.avatar,alt:t.name,className:"profile__avatar"}),r.a.createElement("div",{className:"profile__avatar-hover"})),r.a.createElement("div",{className:"profile__text"},r.a.createElement("div",{className:"profile__namebox"},r.a.createElement("p",{className:"profile__name"}," ",t.name," "),r.a.createElement("button",{className:"profile__edit",onClick:e.onEditProfile})),r.a.createElement("p",{className:"profile__title"}," ",t.about," ")),r.a.createElement("button",{className:"profile__add",onClick:e.onAddPlaceClick}," ")),r.a.createElement("section",{className:"elements"},r.a.createElement("ul",{className:"elements__list"},e.cards.map((function(t,a){return r.a.createElement(f,{key:a,card:t,onImgClick:e.onCardClick,onDelete:e.onCardDelete,onLike:e.onCardLike})})))))};var E=function(){return r.a.createElement("footer",{className:"footer "},r.a.createElement("p",{className:"footer__copyright "},"\xa9 2020 No madic "))};var g=function(e){var t=e.isOpen?"popup_visible":"";return r.a.createElement("div",{className:"popup popup_type_".concat(e.name," ").concat(t)},r.a.createElement("div",{className:"popup__container"},r.a.createElement("button",{onClick:e.closeItAll,type:"submit",className:"popup__close"}," "),r.a.createElement("form",{className:"popup__edit-form",onSubmit:e.onSubmit},r.a.createElement("h3",{className:"popup__heading"}," ",e.heading," "),e.children,r.a.createElement("button",{type:"submit",className:"popup__save"}," ",e.buttonText," "))))};var k=function(e){var t=e.card?"popup_visible":"";return r.a.createElement("div",{className:"popup popup__img ".concat(t)},r.a.createElement("div",{className:"popup__card popup_image"},r.a.createElement("button",{type:"submit",onClick:e.onClose,className:"popup__close popup__closeimg"}," "),r.a.createElement("img",{src:e.card&&e.card.link,alt:e.card.name,className:"popup__image popImg"}),r.a.createElement("p",{className:"popup__imgtext"},e.card.name," ")))},C=new(function(){function e(t,a){Object(i.a)(this,e),this._startUrl=t,this._header=a,this._headerinfo=a.headers}return Object(s.a)(e,[{key:"getUser",value:function(){var e=this._startUrl.concat("group-1/users/me");return this._makeRequests(e)}},{key:"updateUser",value:function(e,t){var a=this._startUrl.concat("/group-1/users/me");return fetch(a,{method:"PATCH",headers:this._headerinfo,body:JSON.stringify({name:e,about:t})}).then((function(e){if(e.ok)return e.json()})).catch((function(e){console.log(e)}))}},{key:"updateAvatar",value:function(e){var t=this._startUrl.concat("/group-1/users/me/avatar");return fetch(t,{method:"PATCH",headers:this._headerinfo,body:JSON.stringify({avatar:e})}).then((function(e){if(e.ok)return e.json()})).catch((function(e){console.log(e)}))}},{key:"_makeRequests",value:function(e){return fetch(e,this._header).then((function(e){return e.ok?e.json():Promise.reject("ERROR: ".concat(e.status))}))}},{key:"deleteCard",value:function(e){var t=this._startUrl.concat("/group-1/cards/"+e);return fetch(t,{method:"DELETE",headers:this._headerinfo}).then((function(e){if(e.ok)return e.json()})).catch((function(e){console.log(e)}))}},{key:"addCard",value:function(e,t){var a=this._startUrl.concat("/group-1/cards");return fetch(a,{method:"POST",headers:this._headerinfo,body:JSON.stringify({name:e,link:t})}).then((function(e){if(e.ok)return e.json()})).catch((function(e){console.log(e)}))}},{key:"likeButton",value:function(e,t){if(t){var a=this._startUrl.concat("/group-1/cards/likes/"+e._id);return fetch(a,{method:"DELETE",headers:this._headerinfo}).then((function(e){if(e.ok)return e.json()})).catch((function(e){console.log(e)}))}var n=this._startUrl.concat("/group-1/cards/likes/"+e._id);return fetch(n,{method:"PUT",headers:this._headerinfo}).then((function(e){if(e.ok)return e.json()})).catch((function(e){console.log(e)}))}},{key:"likeCard",value:function(e){var t=this._startUrl.concat("/group-1/cards/likes/"+e);fetch(t,{method:"PUT",headers:this._headerinfo}).then((function(e){e.ok})).catch((function(e){console.log(e)}))}},{key:"disLike",value:function(e){var t=this._startUrl.concat("/group-1/cards/likes/"+e);fetch(t,{method:"DELETE",headers:this._headerinfo}).then((function(e){e.ok})).catch((function(e){console.log(e)}))}},{key:"getInitialCards",value:function(){return fetch("https://around.nomoreparties.co/v1/group-1/cards",this._header).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}}]),e}())("https://around.nomoreparties.co/v1/",{headers:{authorization:"3aa990c2-b590-4bfb-9403-af52e9b89792","Content-Type":"application/json"}}),b=a(1);var N=function(e){var t=r.a.useContext(_);r.a.useEffect((function(){l(t.name),u(t.about)}),[t]);var a=r.a.useState(t.name),n=Object(b.a)(a,2),o=n[0],l=n[1],c=r.a.useState(t.about),i=Object(b.a)(c,2),s=i[0],u=i[1];return r.a.createElement(g,{name:"changetext",isOpen:e.isOpen,heading:"Edit profile",buttonText:"Save",closeItAll:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser(o,s),e.onClose()}},r.a.createElement("label",{className:"popup__label-group"},r.a.createElement("input",{value:o||"",onChange:function(e){l(e.target.value)},id:"form-name",type:"text",minLength:2,maxLength:40,required:!0,pattern:"[A-Za-z -]{2,40}",className:"popup__edit popup__name popup_head",name:"ProfileName"}),r.a.createElement("span",{id:"form-name--error",className:"popup__edit_error popup__name-error"})),r.a.createElement("label",{className:"popup__label-group"},r.a.createElement("input",{value:s||"",onChange:function(e){u(e.target.value)},id:"form-status",type:"text",minLength:2,maxLength:200,required:!0,className:"popup__edit popup__title popup_detail",name:"profileTitle"}),r.a.createElement("span",{id:"form-status--error",className:"popup__edit_error popup__title-error"})))};var P=function(e){var t=r.a.useContext(_);r.a.useEffect((function(){l(t.avatar)}),[t]);var a=r.a.useState(t.avatar),n=Object(b.a)(a,2),o=n[0],l=n[1],c=r.a.useRef();return r.a.createElement(g,{name:"edit-picture",isOpen:e.isOpen,heading:"Change profile picture",buttonText:"Yes",closeItAll:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateAvatar(c.current.value),c.current.value=null,e.onClose()}},r.a.createElement("label",{className:"popup__label-group"},r.a.createElement("input",{ref:c,id:"user-link",type:"url",placeholder:o,className:"popup__edit_invalid popup__edit popup__url popup_detail ",name:"imgUrl",required:!0}),r.a.createElement("span",{id:"user-link--error",className:"popup__error-input popup__url_error"},"Please enter a URL.")))};var O=function(e){var t=r.a.useState("Name of place"),a=Object(b.a)(t,2),n=a[0],o=a[1],l=r.a.useState("Link to image"),c=Object(b.a)(l,2),i=c[0],s=c[1];return r.a.createElement(g,{name:"addcard",isOpen:e.isAddPopOpen,heading:"New place",buttonText:"Create",closeItAll:e.closeAllPopups,onSubmit:function(t){t.preventDefault(),e.onAddPlace(n,i),e.closeAllPopups()}},r.a.createElement("label",{className:"popup__label-group "},r.a.createElement("input",{id:"form-title",type:"text",minLength:2,maxLength:40,placeholder:"Title",className:"popup__edit_invalid popup__edit popup__place popup_head",name:"placename",required:!0,onChange:function(e){o(e.target.value)}}),r.a.createElement("span",{id:"form-title--error",className:"popup__error-input popup__place-error"}," Please fill out this field.")),r.a.createElement("label",{className:"popup__label-group"},r.a.createElement("input",{id:"form-link",type:"url",placeholder:"Image link",className:"popup__edit_invalid popup__edit popup__url popup_detail",name:"popupurl",required:!0,onChange:function(e){s(e.target.value)}}),r.a.createElement("span",{id:"form-link--error",className:"popup__error-input popup__url_error"},"Please enter a web address.")))},A=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).handleCardClick=function(e){n.setState({selectedCard:e})},n.handleUpdateAvatar=function(e){n.setState({currentUser:e})},n.handleUpdateUser=function(e){n.setState({currentUser:e})},n.handleEditAvatarClick=function(){n.setState({isEditPicOpen:!0})},n.handleEditProfileClick=function(){n.setState({isChangePopOpen:!0})},n.handleAddPlaceClick=function(){n.setState({isAddPopOpen:!0})},n.handleEditUser=function(e,t){C.updateUser(e,t).then((function(e){n.handleUpdateUser(e)}))},n.handleEditAvatar=function(e){C.updateAvatar(e).then((function(e){n.handleUpdateUser(e)}))},n.closeAllPopups=function(){n.setState({isEditPicOpen:!1,isDeletePopOpen:!1,isChangePopOpen:!1,isAddPopOpen:!1,isImagePopOpen:!1,selectedCard:""})},n.handleCardLike=function(e){var t=e.likes.some((function(e){return e._id===n.state.currentUser._id}));C.likeButton(e,t).then((function(e){var t=n.state.cards.map((function(t){return e._id===t._id?e:t}));n.setState({cards:t})}))},n.handleDeleteCard=function(e){e.owner._id===n.state.currentUser._id&&C.deleteCard(e._id).then((function(){var t=n.state.cards.filter((function(t){return t._id!==e._id}));n.setState({cards:t})}))},n.handleAddPlaceSubmit=function(e,t){C.addCard(e,t).then((function(e){n.setState({cards:[].concat(Object(c.a)(n.state.cards),[e])})}))},n.state={isEditPicOpen:!1,isDeletePopOpen:!1,isChangePopOpen:!1,isAddPopOpen:!1,isImagePopOpen:!1,selectedCard:"",currentUser:{},cards:[]},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this;C.getUser().then((function(t){e.handleUpdateUser(t)})).catch((function(e){console.log(e)})),C.getInitialCards().then((function(t){var a=[];t.forEach((function(e){a.push(e)})),e.setState({cards:a})}))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(_.Provider,{value:this.state.currentUser},r.a.createElement(h,null),r.a.createElement(v,{onCardClick:this.handleCardClick,onAvatarClick:this.handleEditAvatarClick,onEditProfile:this.handleEditProfileClick,onAddPlaceClick:this.handleAddPlaceClick,cards:this.state.cards,onCardLike:this.handleCardLike,onCardDelete:this.handleDeleteCard}),r.a.createElement(E,null),r.a.createElement(P,{isOpen:this.state.isEditPicOpen,onClose:this.closeAllPopups,onUpdateAvatar:this.handleEditAvatar}),r.a.createElement(g,{name:"delete-confirm",isOpen:this.state.isDeletePopOpen,heading:"Are you sure ?",buttonText:"Yes",closeItAll:this.closeAllPopups}),r.a.createElement(N,{isOpen:this.state.isChangePopOpen,onClose:this.closeAllPopups,onUpdateUser:this.handleEditUser}),r.a.createElement(O,{isAddPopOpen:this.state.isAddPopOpen,closeAllPopups:this.closeAllPopups,onAddPlace:this.handleAddPlaceSubmit}),r.a.createElement(k,{card:this.state.selectedCard,onClose:this.closeAllPopups})))}}]),a}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(A,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},8:function(e,t,a){e.exports=a.p+"static/media/Vector.782b5eb4.svg"}},[[12,1,2]]]);
//# sourceMappingURL=main.9b734fcc.chunk.js.map